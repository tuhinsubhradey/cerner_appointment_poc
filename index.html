<!DOCTYPE html><html>
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Test Cerner API</title>
<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

  <script type="text/javascript" >
	$(function(){	
		$("#loading").html('Please wait ...');
		$.get('https://aptcarepzm.com/optimal_ai_service/getAppointment',  // url
		  function (data, textStatus, jqXHR) {  // success callback
			  //alert('data:' + data);
			  var responseData = JSON.parse(data)			  
			  //alert(responseData.entry.length)
			  var appHtml =''
			  for(var i=0; i<responseData.entry.length; i++){
				  var resource = responseData.entry[i].resource
				  if (resource.resourceType == "Appointment"){
				  
					appHtml+='<tr>'+
							 '<th colspan="6" align="left">Appointment : '+(i+1)+'</th>'+
							 '</tr><tr>' +
							'<th align="left">Appointment Id :</td><td>'+resource.id +'</td><th align="left">Status :</th><td>'+resource.status +'</td>'+
							'</tr><tr>' +
							'<th align="left">Start Date Time:</th><td>'+resource.start +'</td><th align="left">End Date Time:</th><td>'+resource.end +'</td>'+
							'</tr><tr>';
							for(var j=0; j<resource.participant.length; j++){
								if(resource.participant[j].hasOwnProperty('actor')){
									var actor = resource.participant[j].actor
									//console.log(i+" "+j)
									if(actor.hasOwnProperty('reference')){
										var actor_reference = actor.reference
										if(actor_reference.indexOf('Patient/')!=-1){
											appHtml+='<th align="left">Patient :</th><td>'+actor.display +'</td>'
										}
										if(actor_reference.indexOf('Location/')!=-1){
											appHtml+='<th align="left">Location :</th><td>'+actor.display +'</td></tr>'
										}
										if(actor_reference.indexOf('Practitioner/')!=-1){
											appHtml+='<tr><th align="left">Practitioner :</th><td colspan="5">'+actor.display +'</td></tr>'
										}
									}
								}
							}
							appHtml+='</tr>' 
							//appHtml+=resource.text.div
				  }
			  }
			  $("#loading").html('');
			  $("#app_data").html(appHtml)
		});
	})
  </script>
  <style>

	#app_data {
	  border-collapse: collapse;
	}

</style>
</head>
<body>
	<table width="650" align="center" >
		<tr>
			<td align="left">We are fetching first 10 appointments data from 2019-01-07 onwards for 'MX Clinic 2' Location</td>
		</tr>
		<tr>
			<td id="loading" align="center" style="font-weight:bold" ></td>
		</tr>
	</table>

	<table id="app_data" width="650" align="center" border="1px solid black"></table>	
	
</body>
</html>
